<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UK Government Ministerial Org Chart â€” February 2026</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;500;600;700;800;900&display=swap');
  *{margin:0;padding:0;box-sizing:border-box}
  body{zoom:1.33;font-family:'Source Sans 3','Segoe UI',system-ui,sans-serif;background:#f0f2f5;color:#1a1a2e;min-height:100vh;padding:20px}
  .container{max-width:1100px;margin:0 auto}
  .header{text-align:center;margin-bottom:24px}
  .header-row{display:flex;justify-content:center;align-items:center;gap:12px;margin-bottom:8px}
  .crown-icon{width:36px;height:36px;background:#1a1a2e;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:18px}
  .header h1{font-size:22px;font-weight:800;letter-spacing:-0.5px;color:#1a1a2e}
  .header .subtitle{font-size:12px;color:#5a6577;margin:4px 0 0}
  .header .source{font-size:10px;color:#8a94a6;margin:2px 0 0}
  .key-box{background:#fff;border:1px solid #e2e4e9;border-radius:8px;padding:14px 18px;margin-bottom:16px;position:relative}
  .key-box.hidden{display:none}
  .key-title{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#5a6577;margin-bottom:10px}
  .key-items{display:flex;flex-wrap:wrap;gap:6px 16px;font-size:11px}
  .key-item{display:flex;align-items:center;gap:6px}
  .key-dot{width:8px;height:8px;border-radius:2px;flex-shrink:0}
  .key-label{font-weight:600}
  .key-desc{color:#8a94a6}
  .key-footer{margin-top:8px;font-size:10px;color:#8a94a6;border-top:1px solid #f0f0f0;padding-top:6px}
  .close-btn{position:absolute;top:8px;right:12px;background:none;border:none;cursor:pointer;color:#aaa;font-size:14px}
  .controls{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap;align-items:center}
  .search-input{flex:1;min-width:200px;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:12px;outline:none;background:#fff;font-family:inherit}
  .search-input:focus{border-color:#1a1a2e;box-shadow:0 0 0 2px rgba(26,26,46,0.08)}
  .ctrl-btn{padding:8px 14px;border:1px solid #d1d5db;border-radius:6px;font-size:11px;font-weight:600;background:#fff;cursor:pointer;color:#333;font-family:inherit;transition:background 0.15s;white-space:nowrap}
  .ctrl-btn:hover{background:#f5f6f8}
  .ctrl-btn.active{background:#1a1a2e;color:#fff;border-color:#1a1a2e}
  .filter-bar{display:flex;gap:6px;margin-bottom:16px;flex-wrap:wrap;align-items:center}
  .filter-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.8px;color:#8a94a6}
  .filter-btn{padding:4px 10px;border:1px solid #d1d5db;border-radius:12px;font-size:10px;font-weight:600;background:#fff;cursor:pointer;color:#555;font-family:inherit;transition:all 0.15s}
  .filter-btn:hover{background:#f0f2f5}
  .filter-btn.active{background:#1a1a2e;color:#fff;border-color:#1a1a2e}
  .pm-card{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);color:#fff;padding:16px 20px;border-radius:10px;margin-bottom:16px;box-shadow:0 4px 12px rgba(26,26,46,0.2)}
  .pm-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;opacity:0.6;margin-bottom:6px}
  .pm-name{font-size:18px;font-weight:800;letter-spacing:-0.3px}
  .pm-titles{font-size:11px;opacity:0.65;margin-top:4px}
  .cross-box{background:#fff;border:1px solid #e2e4e9;border-radius:8px;padding:12px 14px;margin-bottom:16px}
  .section-title{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#5a6577;margin-bottom:8px}
  .cross-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:4px}
  .dept-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(340px,1fr));gap:10px;margin-bottom:16px}
  .dept-block{border:1px solid #e2e4e9;border-radius:8px;overflow:hidden;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.04)}
  .dept-header{color:#fff;padding:10px 14px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;user-select:none}
  .dept-header:hover{filter:brightness(1.05)}
  .dept-name{font-size:13px;font-weight:700;letter-spacing:-0.2px}
  .dept-fullname{font-size:10px;opacity:0.8;margin-top:1px}
  .dept-meta{display:flex;align-items:center;gap:8px;flex-shrink:0}
  .dept-count{font-size:10px;opacity:0.75;background:rgba(255,255,255,0.15);padding:2px 8px;border-radius:10px}
  .dept-arrow{font-size:16px;transition:transform 0.2s}
  .dept-arrow.open{transform:rotate(180deg)}
  .dept-body{padding:8px;display:none}
  .dept-body.open{display:block}
  .dept-verified{font-size:9px;opacity:0.65;margin-top:2px;font-style:italic}
  .rank-label{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:1px;padding:4px 4px 2px;border-bottom:1px solid #eee;margin-bottom:2px}
  .rank-label.secretary{border-bottom-color:currentColor}
  .rank-label.mos{color:#5a6577}
  .rank-label.puss{color:#8a94a6}
  .rank-section{margin-bottom:6px}
  .minister-card{padding:8px 12px;margin-bottom:4px;border-radius:4px;transition:box-shadow 0.15s;display:flex;gap:8px;align-items:flex-start}
  .minister-card:hover{box-shadow:0 2px 8px rgba(0,0,0,0.08)}
  .minister-card.secretary{border-left-width:4px;border-left-style:solid;background:#fff}
  .minister-card.mos{border-left-width:3px;border-left-style:solid;background:#fafbfc}
  .minister-card.puss{border-left-width:2px;border-left-style:solid;background:#f5f6f8}
  .minister-photo{width:32px;height:32px;border-radius:50%;flex-shrink:0;background:#e2e4e9;object-fit:cover;margin-top:2px}
  .minister-info{flex:1;min-width:0}
  .minister-name{font-size:12px;font-weight:500;color:#1a1a2e;line-height:1.3}
  .minister-card.secretary .minister-name{font-size:13px;font-weight:700}
  .minister-rt{color:#888;font-size:10px;margin-right:3px}
  .minister-title{font-size:10.5px;color:#5a6577;margin-top:2px;line-height:1.35}
  .badge{display:inline-block;font-size:9px;font-weight:600;letter-spacing:0.5px;text-transform:uppercase;padding:2px 6px;border-radius:3px;margin-left:6px;vertical-align:middle}
  .badge.unpaid{background:#fff3cd;color:#856404}
  .badge.cabinet{background:#d4edda;color:#155724}
  .badge.whip{background:#e2e3e5;color:#383d41}
  .whips-box{background:#fff;border:1px solid #e2e4e9;border-radius:8px;padding:14px 18px;margin-bottom:16px}
  .whips-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:12px}
  .whip-column-title{font-size:10px;font-weight:700;color:#1a1a2e;text-transform:uppercase;letter-spacing:0.8px;margin-bottom:6px;border-bottom:2px solid #1a1a2e;padding-bottom:3px}
  .whip-note{font-size:10px;color:#8a94a6;padding:4px 6px;font-style:italic}
  .lords-whip{padding:5px 10px;font-size:11.5px;border-radius:3px;margin-bottom:2px}
  .lords-whip.senior{color:#1a1a2e;font-weight:600;background:#f5f6f8;border-left:3px solid #1a1a2e}
  .lords-whip.junior{color:#5a6577;font-weight:400;border-left:2px solid #ddd}
  .wealth-badge{display:inline-flex;align-items:center;gap:3px;font-size:9px;font-weight:700;letter-spacing:0.3px;padding:2px 6px;border-radius:3px;margin-left:4px;vertical-align:middle;cursor:help}
  .wealth-badge .wb-icon{font-size:8px}
  .wb-top1{background:#fde8e8;color:#991b1b}
  .wb-top5{background:#fef3c7;color:#92400e}
  .wb-top10{background:#fef9c3;color:#854d0e}
  .wb-top25{background:#ecfdf5;color:#065f46}
  .wb-top50{background:#f0f9ff;color:#1e40af}
  .wb-unknown{background:#f3f4f6;color:#9ca3af}
  .wealth-note-box{background:#fffbeb;border:1px solid #fde68a;border-radius:8px;padding:12px 16px;margin-bottom:16px;font-size:11px;line-height:1.5;color:#92400e}
  .wealth-note-box strong{color:#78350f}
  .minister-constituency{font-size:10px;color:#8a94a6;margin-top:2px;line-height:1.3}
  .minister-constituency a{color:#1d70b8;text-decoration:none;font-weight:500}
  .minister-constituency a:hover{text-decoration:underline}
  .majority-safe{color:#065f46}
  .majority-marginal{color:#b45309}
  .majority-vulnerable{color:#991b1b;font-weight:600}
  .majority-bar-wrap{display:inline-flex;align-items:center;gap:4px;margin-left:4px}
  .majority-bar{height:4px;border-radius:2px;display:inline-block;min-width:4px;max-width:60px}
  .majority-bar.safe{background:#065f46}
  .majority-bar.marginal{background:#b45309}
  .majority-bar.vulnerable{background:#991b1b}
  .dept-budget{font-size:10px;color:rgba(255,255,255,0.85);font-weight:400;margin-top:2px}
  .changelog-box{background:#fff;border:1px solid #e2e4e9;border-radius:8px;padding:14px 18px;margin-bottom:16px}
  .changelog-toggle{font-size:11px;font-weight:600;cursor:pointer;color:#1d70b8;display:flex;align-items:center;gap:6px;user-select:none}
  .changelog-toggle:hover{text-decoration:underline}
  .changelog-body{display:none;margin-top:10px}
  .changelog-body.open{display:block}
  .changelog-entry{padding:6px 0;border-bottom:1px solid #f0f0f0;font-size:11px;line-height:1.5}
  .changelog-entry:last-child{border-bottom:none}
  .changelog-date{font-weight:700;color:#1a1a2e;margin-right:8px}
  .changelog-tag{font-size:9px;font-weight:700;text-transform:uppercase;padding:1px 5px;border-radius:3px;margin-right:4px}
  .changelog-tag.add{background:#d4edda;color:#155724}
  .changelog-tag.remove{background:#fde8e8;color:#991b1b}
  .changelog-tag.change{background:#fef3c7;color:#92400e}
  .changelog-tag.fix{background:#e2e3e5;color:#383d41}
  .cabinet-table{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:8px;margin-bottom:16px}
  .cabinet-card{background:#fff;border:1px solid #e2e4e9;border-radius:8px;padding:10px 12px;text-align:center;transition:box-shadow 0.15s}
  .cabinet-card:hover{box-shadow:0 3px 10px rgba(0,0,0,0.1)}
  .cabinet-card img{width:48px;height:48px;border-radius:50%;object-fit:cover;margin:0 auto 6px;display:block;background:#e2e4e9}
  .cabinet-card .cc-name{font-size:12px;font-weight:700;color:#1a1a2e}
  .cabinet-card .cc-dept{font-size:10px;color:#5a6577;margin-top:2px}
  .cabinet-card .cc-con{font-size:9px;color:#8a94a6;margin-top:3px}
  .view-tabs{display:flex;gap:0;margin-bottom:16px}
  .view-tab{padding:8px 18px;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;cursor:pointer;border:1px solid #d1d5db;background:#fff;color:#555;font-family:inherit;transition:all 0.15s}
  .view-tab:first-child{border-radius:6px 0 0 6px}
  .view-tab:last-child{border-radius:0 6px 6px 0}
  .view-tab:not(:first-child){border-left:none}
  .view-tab.active{background:#1a1a2e;color:#fff;border-color:#1a1a2e}
  .view-tab:hover:not(.active){background:#f5f6f8}
  .footer{text-align:center;font-size:10px;color:#8a94a6;padding:12px;border-top:1px solid #e2e4e9;line-height:1.5}
  @media(max-width:720px){.dept-grid{grid-template-columns:1fr}.key-items{flex-direction:column}.cabinet-table{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}}
  @media print{body{padding:0;background:#fff;font-size:10px}.controls,.filter-bar,.view-tabs,.changelog-box,.ctrl-btn,.search-input,.wealth-note-box,.key-box .close-btn{display:none!important}.dept-body{display:block!important}.dept-grid{grid-template-columns:repeat(2,1fr);gap:6px}.minister-photo{width:20px;height:20px}.pm-card{break-inside:avoid}.dept-block{break-inside:avoid}.whips-box{break-inside:avoid}.header h1{font-size:18px}a{color:inherit!important;text-decoration:none!important}}
</style>
</head>
<body>
<div class="container" id="app"></div>
<script>
// DATA
var DEPARTMENTS = [
  {id:"cabinet-office",name:"Cabinet Office",color:"#1d4e89",verified:"2026-02-09",
    secretary:{name:"Sir Keir Starmer KCB KC MP",title:"Prime Minister, First Lord of the Treasury, Minister for the Civil Service, Minister for the Union",rt:true},
    mos:[
      {name:"Darren Jones MP",title:"Chief Secretary to the PM, Chancellor of the Duchy of Lancaster, Minister for Intergovernmental Relations",rt:true},
      {name:"Nick Thomas-Symonds MP",title:"Paymaster General, Minister for the Cabinet Office (Constitution & EU Relations)",rt:true},
      {name:"Dan Jarvis MBE MP",title:"Minister of State",rt:false},
      {name:"Anna Turley MP",title:"Minister of State (Minister without Portfolio)",rt:true,note:"Unpaid"},
    ],
    puss:[
      {name:"Chris Ward MP",title:"Parliamentary Secretary"},
      {name:"Satvir Kaur MP",title:"Parliamentary Secretary",note:"Unpaid"},
      {name:"Josh Simons MP",title:"Parliamentary Secretary"},
    ]},
  {id:"treasury",name:"HM Treasury",color:"#8b1a1a",verified:"2026-02-09",
    secretary:{name:"Rachel Reeves MP",title:"Chancellor of the Exchequer",rt:true},
    mos:[
      {name:"James Murray MP",title:"Chief Secretary to the Treasury",rt:false,note:"Attends Cabinet"},
      {name:"Lord Livermore",title:"Financial Secretary to the Treasury",rt:false},
      {name:"Lord Stockwood",title:"Minister of State (Minister for Investment)",rt:false,note:"Unpaid"},
    ],
    puss:[
      {name:"Daniel Tomlinson MP",title:"Exchequer Secretary to the Treasury"},
      {name:"Lucy Rigby KC MP",title:"Economic Secretary to the Treasury"},
      {name:"Torsten Bell MP",title:"Parliamentary Secretary"},
    ]},
  {id:"fcdo",name:"Foreign, Commonwealth & Development Office",shortName:"FCDO",color:"#003078",verified:"2026-02-09",
    secretary:{name:"Yvette Cooper MP",title:"Secretary of State for Foreign, Commonwealth and Development Affairs",rt:true},
    mos:[
      {name:"Baroness Chapman of Darlington",title:"Minister of State (International Development & Africa)",rt:true,note:"Attends Cabinet"},
      {name:"Stephen Doughty MP",title:"Minister of State (Europe, North America & Overseas Territories)",rt:false},
    ],
    puss:[
      {name:"Hamish Falconer MP",title:"PUSS (Middle East, N. Africa, Afghanistan & Pakistan)"},
      {name:"Seema Malhotra MP",title:"PUSS (Indo-Pacific)"},
      {name:"Chris Elmore MP",title:"PUSS (Multilateral, Human Rights, Latin America & Caribbean)"},
    ]},
  {id:"home",name:"Home Office",color:"#732282",verified:"2026-02-09",
    secretary:{name:"Shabana Mahmood MP",title:"Secretary of State for the Home Department",rt:true},
    mos:[
      {name:"Dan Jarvis MBE MP",title:"Minister of State (Security)",rt:false},
      {name:"Lord Hanson of Flint",title:"Minister of State (Lords Minister)",rt:true,note:"Unpaid"},
      {name:"Sarah Jones MP",title:"Minister of State (Policing & Crime)",rt:false},
      {name:"Alex Norris MP",title:"Minister of State (Border Security & Asylum)",rt:false},
    ],
    puss:[
      {name:"Jess Phillips MP",title:"PUSS (Safeguarding & VAWG)"},
      {name:"Mike Tapp MP",title:"PUSS (Migration & Citizenship)"},
    ]},
  {id:"mod",name:"Ministry of Defence",shortName:"MoD",color:"#4a4a4a",verified:"2026-02-09",
    secretary:{name:"John Healey MP",title:"Secretary of State for Defence",rt:true},
    mos:[
      {name:"Luke Pollard MP",title:"Minister of State (Defence Readiness & Industry)",rt:false},
      {name:"Lord Coaker",title:"Minister of State (House of Lords)",rt:false},
    ],
    puss:[
      {name:"Alistair Carns DSO OBE MC MP",title:"PUSS (Armed Forces)"},
      {name:"Louise Sandher-Jones MP",title:"PUSS (Veterans & People)"},
    ]},
  {id:"moj",name:"Ministry of Justice",shortName:"MoJ",color:"#231f20",verified:"2026-02-09",
    secretary:{name:"David Lammy MP",title:"Deputy PM, Lord Chancellor & Secretary of State for Justice",rt:true},
    mos:[
      {name:"Lord Timpson OBE",title:"Minister of State (Prisons, Probation & Reducing Reoffending)",rt:false,note:"Unpaid"},
      {name:"Sarah Sackman KC MP",title:"Minister of State (Courts & Legal Services)",rt:false},
    ],
    puss:[
      {name:"Alex Davies-Jones MP",title:"PUSS (Victims & Tackling VAWG)"},
      {name:"Baroness Levitt KC",title:"PUSS & Lords Minister",note:"Unpaid"},
      {name:"Jake Richards MP",title:"PUSS (Sentencing, Youth Justice & International)",note:"Paid as whip"},
    ]},
  {id:"mhclg",name:"Ministry of Housing, Communities & Local Government",shortName:"MHCLG",color:"#f47738",verified:"2026-02-09",
    secretary:{name:"Steve Reed OBE MP",title:"Secretary of State for Housing, Communities and Local Government",rt:true},
    mos:[
      {name:"Matthew Pennycook MP",title:"Minister of State (Housing & Planning)",rt:false},
      {name:"Alison McGovern MP",title:"Minister of State (Local Government & Homelessness)",rt:false},
    ],
    puss:[
      {name:"Baroness Taylor of Stevenage",title:"PUSS (Lords Minister for Housing & LG)",note:"Paid as whip"},
      {name:"Miatta Fahnbulleh MP",title:"PUSS (Devolution, Faith & Communities)"},
      {name:"Samantha Dixon MBE MP",title:"PUSS (Building Safety, Fire & Democracy)"},
    ]},
  {id:"dhsc",name:"Department of Health & Social Care",shortName:"DHSC",color:"#00703c",verified:"2026-02-09",
    secretary:{name:"Wes Streeting MP",title:"Secretary of State for Health and Social Care",rt:true},
    mos:[
      {name:"Karin Smyth MP",title:"Minister of State for Health (Secondary Care)",rt:false},
      {name:"Stephen Kinnock MP",title:"Minister of State for Care",rt:false},
    ],
    puss:[
      {name:"Baroness Merron",title:"PUSS (Women\u2019s Health & Mental Health)"},
      {name:"Ashley Dalton MP",title:"PUSS (Public Health & Prevention)"},
      {name:"Dr Zubir Ahmed MP",title:"PUSS (Health Innovation & Safety)"},
    ]},
  {id:"dfe",name:"Department for Education",shortName:"DfE",color:"#d4351c",verified:"2026-02-09",
    secretary:{name:"Bridget Phillipson MP",title:"Secretary of State for Education, Minister for Women & Equalities",rt:true},
    mos:[
      {name:"Georgia Gould OBE MP",title:"Minister of State (School Standards)",rt:false},
      {name:"Baroness Smith of Malvern",title:"Minister of State (Women & Equalities / Skills)",rt:true},
      {name:"Sir Stephen Timms MP",title:"Minister of State (Social Security & Disability)",rt:true},
    ],
    puss:[
      {name:"Olivia Bailey MP",title:"PUSS (Early Education / Equalities)"},
      {name:"Josh MacAlister OBE MP",title:"PUSS (Children & Families)"},
      {name:"Seema Malhotra MP",title:"PUSS (Equalities)"},
    ]},
  {id:"desnz",name:"Department for Energy Security & Net Zero",shortName:"DESNZ",color:"#28a197",verified:"2026-02-09",
    secretary:{name:"Ed Miliband MP",title:"Secretary of State for Energy Security and Net Zero",rt:true},
    mos:[
      {name:"Lord Vallance",title:"Minister of State (Science, Innovation, Research & Nuclear)",rt:false},
      {name:"Michael Shanks MP",title:"Minister of State (Energy)",rt:false},
      {name:"Lord Whitehead",title:"Minister of State (Energy Security & Net Zero)",rt:false,note:"Unpaid"},
    ],
    puss:[
      {name:"Katie White OBE MP",title:"PUSS (Climate)"},
      {name:"Martin McCluskey MP",title:"PUSS (Energy Consumers)"},
      {name:"Chris McDonald MP",title:"PUSS (Industry)"},
    ]},
  {id:"dwp",name:"Department for Work & Pensions",shortName:"DWP",color:"#003078",verified:"2026-02-09",
    secretary:{name:"Pat McFadden MP",title:"Secretary of State for Work and Pensions",rt:true},
    mos:[
      {name:"Sir Stephen Timms MP",title:"Minister of State (Social Security & Disability)",rt:true},
      {name:"Dame Diana Johnson DBE MP",title:"Minister of State (Employment)",rt:true},
      {name:"Baroness Smith of Malvern",title:"Minister of State (Skills)",rt:true},
      {name:"Baroness Sherlock OBE",title:"Minister of State (Lords)",rt:false},
    ],
    puss:[
      {name:"Andrew Western MP",title:"PUSS (Transformation)"},
      {name:"Torsten Bell MP",title:"PUSS (Pensions)"},
    ]},
  {id:"dbt",name:"Department for Business & Trade",shortName:"DBT",color:"#1d70b8",verified:"2026-02-09",
    secretary:{name:"Peter Kyle MP",title:"Secretary of State for Business and Trade, President of the Board of Trade",rt:true},
    mos:[
      {name:"Lord Stockwood",title:"Minister of State (Investment)",rt:false,note:"Unpaid"},
      {name:"Sir Chris Bryant MP",title:"Minister of State (Trade)",rt:false},
    ],
    puss:[
      {name:"Blair McDougall MP",title:"PUSS (Small Business & Economic Transformation)"},
      {name:"Kate Dearden MP",title:"PUSS (Employment Rights & Consumer Protection)"},
      {name:"Baroness Lloyd of Effra CBE",title:"PUSS (Digital Economy)",note:"Paid as whip"},
      {name:"Chris McDonald MP",title:"PUSS (Industry)"},
    ]},
  {id:"dsit",name:"Department for Science, Innovation & Technology",shortName:"DSIT",color:"#4c2c92",verified:"2026-02-09",
    secretary:{name:"Liz Kendall MP",title:"Secretary of State for Science, Innovation and Technology",rt:true},
    mos:[
      {name:"Lord Vallance",title:"Minister of State (Science, Innovation, Research & Nuclear)",rt:false},
      {name:"Ian Murray MP",title:"Minister of State (Digital Government & Data)",rt:true},
    ],
    puss:[
      {name:"Baroness Lloyd of Effra CBE",title:"PUSS (Digital Economy)",note:"Paid as whip"},
      {name:"Kanishka Narayan MP",title:"PUSS (AI & Online Safety)"},
      {name:"Josh Simons MP",title:"PUSS (Department for Science, Innovation and Technology)"},
    ]},
  {id:"dft",name:"Department for Transport",shortName:"DfT",color:"#862633",verified:"2026-02-09",
    secretary:{name:"Heidi Alexander MP",title:"Secretary of State for Transport",rt:true},
    mos:[
      {name:"Lord Hendy of Richmond Hill CBE",title:"Minister of State (Rail)",rt:false,note:"Unpaid"},
    ],
    puss:[
      {name:"Simon Lightwood MP",title:"PUSS (Roads & Buses)"},
      {name:"Lilian Greenwood MP",title:"PUSS (Local Transport)"},
      {name:"Keir Mather MP",title:"PUSS (Aviation, Maritime & Decarbonisation)"},
    ]},
  {id:"defra",name:"Department for Environment, Food & Rural Affairs",shortName:"Defra",color:"#00703c",verified:"2026-02-09",
    secretary:{name:"Emma Reynolds MP",title:"Secretary of State for Environment, Food and Rural Affairs",rt:true},
    mos:[
      {name:"Dame Angela Eagle DBE MP",title:"Minister of State (Food Security & Rural Affairs)",rt:false},
    ],
    puss:[
      {name:"Emma Hardy MP",title:"PUSS (Water & Flooding)"},
      {name:"Mary Creagh CBE MP",title:"PUSS (Nature)"},
      {name:"Baroness Hayman of Ullock",title:"PUSS (Biosecurity, Borders & Animals)"},
    ]},
  {id:"dcms",name:"Department for Culture, Media & Sport",shortName:"DCMS",color:"#d4351c",verified:"2026-02-09",
    secretary:{name:"Lisa Nandy MP",title:"Secretary of State for Culture, Media and Sport",rt:true},
    mos:[
      {name:"Ian Murray MP",title:"Minister of State (Creative Industries, Media & Arts)",rt:true},
    ],
    puss:[
      {name:"Stephanie Peacock MP",title:"PUSS (Sport, Tourism, Civil Society & Youth)"},
      {name:"Baroness Twycross",title:"PUSS (Museums, Heritage & Gambling, Lords Minister)"},
    ]},
  {id:"nio",name:"Northern Ireland Office",shortName:"NIO",color:"#4c2c92",verified:"2026-02-09",
    secretary:{name:"Hilary Benn MP",title:"Secretary of State for Northern Ireland",rt:true},
    mos:[],puss:[{name:"Matthew Patrick MP",title:"PUSS"}]},
  {id:"scotland",name:"Scotland Office",color:"#0065bd",verified:"2026-02-09",
    secretary:{name:"Douglas Alexander MP",title:"Secretary of State for Scotland",rt:true},
    mos:[],puss:[{name:"Kirsty McNeill MP",title:"PUSS"}]},
  {id:"wales",name:"Wales Office",color:"#a33038",verified:"2026-02-09",
    secretary:{name:"Jo Stevens MP",title:"Secretary of State for Wales",rt:true},
    mos:[],
    puss:[
      {name:"Anna McMorrin MP",title:"Parliamentary Under-Secretary of State for Wales"},
      {name:"Claire Hughes MP",title:"Parliamentary Under-Secretary of State in the Wales Office, Assistant Whip",note:"Paid as whip"},
    ]},
];

var CROSS_CUTTING = [
  {name:"Sir Alan Campbell MP",title:"Lord President of the Council, Leader of the House of Commons",rt:true,note:"Attends Cabinet"},
  {name:"Baroness Smith of Basildon",title:"Lord Privy Seal, Leader of the House of Lords",rt:true},
  {name:"Lord Hermer KC",title:"Attorney General",rt:true,note:"Attends Cabinet"},
  {name:"Ellie Reeves MP",title:"Solicitor General",rt:true},
];

var LORDS_WHIPS = [
  "Baroness Anderson of Stoke-on-Trent (Chief Whip, Lords)",
  "Lord Collins of Highbury (Deputy Chief Whip, Lords)",
  "Baroness Blake of Leeds","Lord Katz","Lord Lemos","Lord Leong","Lord Wilson of Sedgefield",
];

var CHANGELOG = [
  {date:"2026-02-09",entries:[
    {tag:"fix",text:"Wales Office: replaced Nia Griffith with Anna McMorrin MP and Claire Hughes MP"},
    {tag:"fix",text:"Whips: added Sir Mark Tami MP as Deputy Chief Whip; corrected Sir Nic Dakin to Government Whip"},
    {tag:"change",text:"DESNZ: Dr Alan Whitehead CBE \u2192 Lord Whitehead (peerage Nov 2025)"},
    {tag:"fix",text:"Defra: Emma Reynolds rt flag corrected to true"},
    {tag:"add",text:"DSIT: Josh Simons MP cross-listed as PUSS"},
    {tag:"add",text:"Features: headshots, cabinet table, seniority filters, budget sort, changelog, print, majority bars"},
  ]},
  {date:"2026-02-08",entries:[
    {tag:"add",text:"Initial release with wealth percentiles, constituency data, departmental budgets"},
  ]},
];

var WEALTH_EST = {
  "Sir Keir Starmer KCB KC MP":5500000,"David Lammy MP":5000000,"Rachel Reeves MP":2500000,
  "Yvette Cooper MP":3000000,"Shabana Mahmood MP":1200000,"Pat McFadden MP":1500000,
  "Darren Jones MP":1000000,"John Healey MP":1800000,"Wes Streeting MP":800000,
  "Bridget Phillipson MP":700000,"Ed Miliband MP":3500000,"Steve Reed OBE MP":1000000,
  "Peter Kyle MP":900000,"Liz Kendall MP":1000000,"Heidi Alexander MP":800000,
  "Emma Reynolds MP":900000,"Lisa Nandy MP":1000000,"Hilary Benn MP":2000000,
  "Douglas Alexander MP":2000000,"Jo Stevens MP":1200000,"Jonathan Reynolds MP":1000000,
  "Baroness Smith of Basildon":1500000,"Sir Alan Campbell MP":1500000,
  "James Murray MP":600000,"Lord Hermer KC":8000000,"Anna Turley MP":600000,
  "Baroness Chapman of Darlington":1200000,"Nick Thomas-Symonds MP":1200000,
  "Lord Livermore":1500000,"Lord Stockwood":15000000,"Daniel Tomlinson MP":500000,
  "Lucy Rigby KC MP":1500000,"Torsten Bell MP":800000,"Stephen Doughty MP":800000,
  "Hamish Falconer MP":600000,"Seema Malhotra MP":1200000,"Chris Elmore MP":700000,
  "Dan Jarvis MBE MP":1000000,"Lord Hanson of Flint":1500000,"Sarah Jones MP":800000,
  "Alex Norris MP":600000,"Jess Phillips MP":900000,"Mike Tapp MP":500000,
  "Luke Pollard MP":700000,"Lord Coaker":1500000,"Alistair Carns DSO OBE MC MP":600000,
  "Louise Sandher-Jones MP":500000,"Lord Timpson OBE":50000000,"Sarah Sackman KC MP":2000000,
  "Alex Davies-Jones MP":600000,"Baroness Levitt KC":3000000,"Jake Richards MP":400000,
  "Matthew Pennycook MP":700000,"Alison McGovern MP":800000,"Baroness Taylor of Stevenage":1200000,
  "Miatta Fahnbulleh MP":500000,"Samantha Dixon MBE MP":700000,"Karin Smyth MP":800000,
  "Stephen Kinnock MP":2500000,"Baroness Merron":1200000,"Ashley Dalton MP":500000,
  "Dr Zubir Ahmed MP":1500000,"Georgia Gould OBE MP":800000,"Baroness Smith of Malvern":1500000,
  "Sir Stephen Timms MP":1500000,"Olivia Bailey MP":400000,"Josh MacAlister OBE MP":600000,
  "Lord Vallance":5000000,"Michael Shanks MP":500000,"Lord Whitehead":1200000,
  "Katie White OBE MP":500000,"Martin McCluskey MP":400000,"Chris McDonald MP":700000,
  "Dame Diana Johnson DBE MP":1200000,"Baroness Sherlock OBE":1000000,"Andrew Western MP":500000,
  "Sir Chris Bryant MP":1200000,"Blair McDougall MP":500000,"Kate Dearden MP":400000,
  "Baroness Lloyd of Effra CBE":2000000,"Ian Murray MP":1200000,"Kanishka Narayan MP":1500000,
  "Lord Hendy of Richmond Hill CBE":5000000,"Simon Lightwood MP":500000,
  "Lilian Greenwood MP":800000,"Keir Mather MP":300000,"Dame Angela Eagle DBE MP":1500000,
  "Emma Hardy MP":600000,"Mary Creagh CBE MP":1000000,"Baroness Hayman of Ullock":1000000,
  "Stephanie Peacock MP":600000,"Baroness Twycross":800000,"Matthew Patrick MP":400000,
  "Kirsty McNeill MP":500000,"Anna McMorrin MP":800000,"Claire Hughes MP":500000,
  "Ellie Reeves MP":1500000,"Josh Simons MP":500000,"Chris Ward MP":400000,
  "Satvir Kaur MP":400000,"Sir Mark Tami MP":1200000,"Sir Nic Dakin MP":800000,
};

var MP_INFO = {
  "Sir Keir Starmer KCB KC MP":{con:"Holborn and St Pancras",maj:11572,parlId:4514},
  "David Lammy MP":{con:"Tottenham",maj:19821,parlId:206},
  "Rachel Reeves MP":{con:"Leeds West and Pudsey",maj:10824,parlId:4031},
  "Yvette Cooper MP":{con:"Pontefract, Castleford and Knottingley",maj:14639,parlId:420},
  "Shabana Mahmood MP":{con:"Birmingham Ladywood",maj:5703,parlId:3914},
  "Pat McFadden MP":{con:"Wolverhampton South East",maj:8761,parlId:1587},
  "Darren Jones MP":{con:"Bristol North West",maj:13204,parlId:4621},
  "John Healey MP":{con:"Rawmarsh and Conisbrough",maj:9821,parlId:400},
  "Wes Streeting MP":{con:"Ilford North",maj:528,parlId:4504},
  "Bridget Phillipson MP":{con:"Houghton and Sunderland South",maj:13788,parlId:4046},
  "Ed Miliband MP":{con:"Doncaster North",maj:9800,parlId:1510},
  "Steve Reed OBE MP":{con:"Streatham and Croydon North",maj:17327,parlId:4268},
  "Peter Kyle MP":{con:"Hove and Portslade",maj:16107,parlId:4505},
  "Liz Kendall MP":{con:"Leicester West",maj:6975,parlId:4026},
  "Heidi Alexander MP":{con:"Swindon South",maj:5765,parlId:4038},
  "Emma Reynolds MP":{con:"Wycombe",maj:5643,parlId:4077},
  "Lisa Nandy MP":{con:"Wigan",maj:14523,parlId:4082},
  "Hilary Benn MP":{con:"Leeds South",maj:16573,parlId:413},
  "Douglas Alexander MP":{con:"Lothian East",maj:8822,parlId:632},
  "Jo Stevens MP":{con:"Cardiff East",maj:14875,parlId:4425},
  "Jonathan Reynolds MP":{con:"Stalybridge and Hyde",maj:10695,parlId:4119},
  "Nick Thomas-Symonds MP":{con:"Torfaen",maj:14380,parlId:4479},
  "Dan Jarvis MBE MP":{con:"Barnsley North",maj:8609,parlId:4243},
  "Anna Turley MP":{con:"Redcar",maj:9636,parlId:4449},
  "James Murray MP":{con:"Ealing North",maj:12060,parlId:4797},
  "Chris Ward MP":{con:"Brighton Kemptown and Peacehaven",maj:11119,parlId:5276},
  "Satvir Kaur MP":{con:"Southampton Test",maj:9671,parlId:5271},
  "Josh Simons MP":{con:"Makerfield",maj:10710,parlId:5060},
  "Daniel Tomlinson MP":{con:"Chipping Barnet",maj:2566,parlId:5282},
  "Lucy Rigby KC MP":{con:"Northampton North",maj:6135,parlId:5333},
  "Torsten Bell MP":{con:"Swansea West",maj:8703,parlId:5069},
  "Stephen Doughty MP":{con:"Cardiff South and Penarth",maj:13218,parlId:4264},
  "Hamish Falconer MP":{con:"Lincoln",maj:5270,parlId:5148},
  "Seema Malhotra MP":{con:"Feltham and Heston",maj:14015,parlId:4253},
  "Chris Elmore MP":{con:"Bridgend",maj:10420,parlId:4572},
  "Sarah Jones MP":{con:"Croydon West",maj:12838,parlId:4631},
  "Alex Norris MP":{con:"Nottingham North and Kimberley",maj:12558,parlId:4641},
  "Jess Phillips MP":{con:"Birmingham Yardley",maj:693,parlId:4370},
  "Mike Tapp MP":{con:"Dover and Deal",maj:4860,parlId:5266},
  "Luke Pollard MP":{con:"Plymouth Sutton and Devonport",maj:9389,parlId:4682},
  "Alistair Carns DSO OBE MC MP":{con:"Birmingham Selly Oak",maj:6723,parlId:5235},
  "Louise Sandher-Jones MP":{con:"North East Derbyshire",maj:1753,parlId:5258},
  "Sarah Sackman KC MP":{con:"Finchley and Golders Green",maj:5765,parlId:5204},
  "Alex Davies-Jones MP":{con:"Pontypridd",maj:13560,parlId:4849},
  "Jake Richards MP":{con:"Rother Valley",maj:6792,parlId:5082},
  "Matthew Pennycook MP":{con:"Greenwich and Woolwich",maj:16745,parlId:4520},
  "Alison McGovern MP":{con:"Birkenhead",maj:14841,parlId:4083},
  "Miatta Fahnbulleh MP":{con:"Peckham",maj:25110,parlId:5099},
  "Samantha Dixon MBE MP":{con:"Chester North and Neston",maj:15103,parlId:4960},
  "Karin Smyth MP":{con:"Bristol South",maj:11804,parlId:4444},
  "Stephen Kinnock MP":{con:"Aberafan Maesteg",maj:12019,parlId:4359},
  "Ashley Dalton MP":{con:"West Lancashire",maj:12174,parlId:4981},
  "Dr Zubir Ahmed MP":{con:"Glasgow South West",maj:5565,parlId:5213},
  "Georgia Gould OBE MP":{con:"Queen\u2019s Park and Maida Vale",maj:19125,parlId:5305},
  "Sir Stephen Timms MP":{con:"East Ham",maj:13174,parlId:163},
  "Olivia Bailey MP":{con:"Reading West and Mid Berkshire",maj:6541,parlId:5337},
  "Josh MacAlister OBE MP":{con:"Whitehaven and Workington",maj:5283,parlId:5033},
  "Michael Shanks MP":{con:"Rutherglen",maj:10080,parlId:4998},
  "Katie White OBE MP":{con:"Leeds North West",maj:6700,parlId:5260},
  "Martin McCluskey MP":{con:"Inverclyde and Renfrewshire West",maj:7625,parlId:5129},
  "Chris McDonald MP":{con:"Stockton North",maj:12123,parlId:5116},
  "Dame Diana Johnson DBE MP":{con:"Kingston upon Hull North and Cottingham",maj:12356,parlId:1533},
  "Andrew Western MP":{con:"Stretford and Urmston",maj:14156,parlId:4979},
  "Sir Chris Bryant MP":{con:"Rhondda and Ogmore",maj:14787,parlId:1446},
  "Blair McDougall MP":{con:"East Renfrewshire",maj:8675,parlId:5076},
  "Kate Dearden MP":{con:"Halifax",maj:7376,parlId:5224},
  "Ian Murray MP":{con:"Edinburgh South",maj:11095,parlId:3966},
  "Kanishka Narayan MP":{con:"Vale of Glamorgan",maj:4032,parlId:5039},
  "Simon Lightwood MP":{con:"Wakefield and Rothwell",maj:10823,parlId:4943},
  "Lilian Greenwood MP":{con:"Nottingham South",maj:10127,parlId:4029},
  "Keir Mather MP":{con:"Selby",maj:4161,parlId:4993},
  "Dame Angela Eagle DBE MP":{con:"Wallasey",maj:12689,parlId:491},
  "Emma Hardy MP":{con:"Kingston upon Hull West and Hessle",maj:11207,parlId:4645},
  "Mary Creagh CBE MP":{con:"Coventry East",maj:11674,parlId:1538},
  "Stephanie Peacock MP":{con:"Barnsley South",maj:8980,parlId:4607},
  "Matthew Patrick MP":{con:"Wirral West",maj:9998,parlId:5162},
  "Kirsty McNeill MP":{con:"Midlothian",maj:5832,parlId:5114},
  "Anna McMorrin MP":{con:"Cardiff North",maj:10279,parlId:4632},
  "Claire Hughes MP":{con:"Bangor Aberconwy",maj:3378,parlId:5113},
  "Sir Alan Campbell MP":{con:"Tynemouth",maj:17291,parlId:529},
  "Ellie Reeves MP":{con:"Lewisham North",maj:19854,parlId:4620},
  "Sir Mark Tami MP":{con:"Alyn and Deeside",maj:8083,parlId:1383},
  "Sir Nic Dakin MP":{con:"Scunthorpe",maj:6978,parlId:4056},
  "Lord Hermer KC":{},"Lord Livermore":{},"Lord Stockwood":{},
  "Baroness Chapman of Darlington":{},"Lord Hanson of Flint":{parlId:533},
  "Lord Coaker":{parlId:360},"Lord Timpson OBE":{parlId:1605},"Baroness Levitt KC":{},
  "Baroness Taylor of Stevenage":{},"Baroness Merron":{},
  "Baroness Smith of Malvern":{},"Lord Vallance":{},"Lord Whitehead":{parlId:62},
  "Baroness Sherlock OBE":{},"Baroness Lloyd of Effra CBE":{},
  "Lord Hendy of Richmond Hill CBE":{},"Baroness Hayman of Ullock":{},
  "Baroness Twycross":{},"Baroness Smith of Basildon":{},
};

var DEPT_BUDGET = {
  "cabinet-office":12.6,"treasury":48.0,"fcdo":15.1,"home":19.6,
  "mod":56.6,"moj":11.8,"mhclg":37.4,"dhsc":201.7,"dfe":95.0,
  "desnz":10.9,"dwp":8.5,"dbt":3.3,"dsit":10.4,"dft":29.8,
  "defra":7.3,"dcms":5.4,"nio":0.5,"scotland":0.1,"wales":0.1,
};

// WEALTH PERCENTILE
var WPT=[[0,0],[15000,25],[50000,40],[104000,50],[200000,65],[340000,75],[430000,85],[530000,90],[700000,95],[1000000,97],[1400000,98],[1900000,99],[3500000,99.5],[5000000,99.9],[10000000,99.95],[50000000,99.99]];
function getPercentile(w){if(w==null)return null;for(var i=WPT.length-1;i>=0;i--)if(w>=WPT[i][0])return WPT[i][1];return 0}
function getPercentileClass(p){if(p==null)return"wb-unknown";if(p>=99)return"wb-top1";if(p>=95)return"wb-top5";if(p>=90)return"wb-top10";if(p>=75)return"wb-top25";return"wb-top50"}
function formatWealth(w){if(w==null)return"?";if(w>=10000000)return"\u00a3"+(w/1000000).toFixed(0)+"m";if(w>=1000000)return"\u00a3"+(w/1000000).toFixed(1)+"m";return"\u00a3"+(w/1000).toFixed(0)+"k"}
function wealthBadgeHTML(n){if(!showWealth)return"";var w=WEALTH_EST[n],p=getPercentile(w),cls=getPercentileClass(p);var pL=p!=null?"Top "+parseFloat((100-p).toFixed(2))+"%":"N/A";var t=p!=null?"Est. wealth: "+formatWealth(w)+" \u2014 Wealthier than ~"+p+"% of UK adults":"Insufficient data";return' <span class="wealth-badge '+cls+'" title="'+t+'"><span class="wb-icon">\u00a3</span>'+pL+'</span>'}
function photoURL(n){var i=MP_INFO[n];if(!i||!i.parlId)return null;return"https://members-api.parliament.uk/api/Members/"+i.parlId+"/Thumbnail"}
function constituencyHTML(n){var i=MP_INFO[n];if(!i||!i.con)return"";var m=i.maj,c="safe";if(m<2000)c="vulnerable";else if(m<6000)c="marginal";var bw=Math.min(60,Math.max(4,Math.round(m/500)));var lnk=i.parlId?'<a href="https://members.parliament.uk/member/'+i.parlId+'/contact" target="_blank" rel="noopener">'+esc(i.con)+'</a>':esc(i.con);return'<div class="minister-constituency">'+lnk+' <span class="majority-bar-wrap"><span class="majority-bar '+c+'" style="width:'+bw+'px"></span><span class="majority-'+c+'" title="2024 majority: '+m.toLocaleString()+'">maj. '+m.toLocaleString()+'</span></span></div>'}

// STATE
var expandedDepts=new Set(["cabinet-office","treasury"]);
var allExpanded=false,showKey=true,searchTerm="",showWealth=true,showChangelog=false;
var currentView="full",seniorityFilter="all",sortByBudget=false;

// HELPERS
function esc(s){var d=document.createElement("div");d.textContent=s;return d.innerHTML}
function badgeHTML(note){if(!note)return"";var c="whip";if(note==="Unpaid")c="unpaid";else if(note==="Attends Cabinet")c="cabinet";return'<span class="badge '+c+'">'+esc(note)+'</span>'}
function ministerHTML(m,rank,color){var op=rank==="mos"?"80":rank==="puss"?"50":"";var ph=photoURL(m.name);var pt=ph?'<img class="minister-photo" src="'+ph+'" alt="" loading="lazy" onerror="this.style.display=\'none\'">':'';return'<div class="minister-card '+rank+'" style="border-left-color:'+color+op+'">'+pt+'<div class="minister-info"><div class="minister-name">'+(m.rt?'<span class="minister-rt">Rt Hon </span>':"")+esc(m.name)+badgeHTML(m.note)+wealthBadgeHTML(m.name)+'</div><div class="minister-title">'+esc(m.title)+'</div>'+constituencyHTML(m.name)+'</div></div>'}

function deptHTML(dept){var isOpen=expandedDepts.has(dept.id)||searchTerm.length>0;var total=1+dept.mos.length+dept.puss.length;var dn=dept.shortName||dept.name;var fnl=dept.shortName?'<div class="dept-fullname">'+esc(dept.name)+'</div>':"";var b=DEPT_BUDGET[dept.id];var bl=b!=null?'<div class="dept-budget">\u00a3'+b+'bn Total DEL 2025\u201326</div>':"";var vl=dept.verified?'<div class="dept-verified">Verified '+dept.verified+'</div>':"";
var body="";var sS=seniorityFilter==="all"||seniorityFilter==="cabinet"||seniorityFilter==="sos";var sM=seniorityFilter==="all"||seniorityFilter==="mos";var sP=seniorityFilter==="all";
if(sS){body+='<div class="rank-section"><div class="rank-label secretary" style="color:'+dept.color+'">Secretary of State</div>';body+=ministerHTML(dept.secretary,"secretary",dept.color);body+='</div>'}
if(sM&&dept.mos.length){body+='<div class="rank-section"><div class="rank-label mos">Ministers of State</div>';dept.mos.forEach(function(m){body+=ministerHTML(m,"mos",dept.color)});body+='</div>'}
if(sP&&dept.puss.length){body+='<div class="rank-section"><div class="rank-label puss">Parliamentary Under-Secretaries</div>';dept.puss.forEach(function(m){body+=ministerHTML(m,"puss",dept.color)});body+='</div>'}
return'<div class="dept-block" data-id="'+dept.id+'"><div class="dept-header" style="background:linear-gradient(135deg,'+dept.color+','+dept.color+'dd)" onclick="toggleDept(\''+dept.id+'\')"><div><div class="dept-name">'+esc(dn)+'</div>'+fnl+bl+vl+'</div><div class="dept-meta"><span class="dept-count">'+total+' ministers</span><span class="dept-arrow'+(isOpen?" open":"")+'">&#9662;</span></div></div><div class="dept-body'+(isOpen?" open":"")+'">'+ body+'</div></div>'}

function getCabinetMembers(){var ms=[];ms.push({name:"Sir Keir Starmer KCB KC MP",title:"Prime Minister",dept:"Cabinet Office",color:"#1a1a2e"});DEPARTMENTS.forEach(function(d){if(d.secretary.name!=="Sir Keir Starmer KCB KC MP")ms.push({name:d.secretary.name,title:d.secretary.title.split(",")[0],dept:d.shortName||d.name,color:d.color});d.mos.forEach(function(m){if(m.note==="Attends Cabinet")ms.push({name:m.name,title:m.title.split(",")[0],dept:d.shortName||d.name,color:d.color})})});CROSS_CUTTING.forEach(function(m){ms.push({name:m.name,title:m.title.split(",")[0],dept:"Cross-cutting",color:"#1a1a2e"})});return ms}

// RENDER
function render(){
  var depts=DEPARTMENTS.slice();
  if(sortByBudget)depts.sort(function(a,b){return(DEPT_BUDGET[b.id]||0)-(DEPT_BUDGET[a.id]||0)});
  var filtered=searchTerm?depts.filter(function(d){var t=searchTerm.toLowerCase();var all=[d.secretary].concat(d.mos,d.puss).map(function(m){return(m.name+" "+m.title).toLowerCase()});return d.name.toLowerCase().includes(t)||(d.shortName||"").toLowerCase().includes(t)||all.some(function(n){return n.includes(t)})}):depts;
  var totalMinisters=DEPARTMENTS.reduce(function(s,d){return s+1+d.mos.length+d.puss.length},0);
  var h="";

  // Header
  h+='<div class="header"><div class="header-row"><div class="crown-icon">\ud83d\udc51</div><h1>His Majesty\u2019s Government</h1></div><p class="subtitle">UK Government Ministerial Structure \u2014 '+totalMinisters+' ministerial posts across '+DEPARTMENTS.length+' departments</p><p class="source">Source: GOV.UK \u2022 Data as of February 2026</p></div>';

  // Changelog
  h+='<div class="changelog-box"><div class="changelog-toggle" onclick="toggleChangelog()">\ud83d\udccb What\u2019s changed'+(showChangelog?' \u25b4':' \u25be')+'</div><div class="changelog-body'+(showChangelog?" open":"")+'">';
  CHANGELOG.forEach(function(g){g.entries.forEach(function(e){h+='<div class="changelog-entry"><span class="changelog-date">'+g.date+'</span><span class="changelog-tag '+e.tag+'">'+e.tag+'</span>'+esc(e.text)+'</div>'})});
  h+='</div></div>';

  // Key
  if(showKey){
    var kr=[{l:"1. Prime Minister",d:"Head of Government",c:"#1a1a2e"},{l:"2. Secretary of State",d:"Cabinet minister",c:"#333"},{l:"3. Minister of State",d:"Senior junior minister",c:"#555"},{l:"4. PUSS",d:"Junior minister",c:"#777"},{l:"5. PPS",d:"Not a minister (omitted)",c:"#999"}];
    h+='<div class="key-box" id="key-box"><button class="close-btn" onclick="hideKey()">\u2715</button><div class="key-title">Ministerial Hierarchy</div><div class="key-items">'+kr.map(function(r){return'<div class="key-item"><div class="key-dot" style="background:'+r.c+'"></div><span class="key-label" style="color:'+r.c+'">'+r.l+'</span><span class="key-desc">\u2014 '+r.d+'</span></div>'}).join("")+'</div><div class="key-footer">Majority bars: <span class="majority-bar safe" style="display:inline-block;width:20px;vertical-align:middle"></span> safe (6k+) \u00b7 <span class="majority-bar marginal" style="display:inline-block;width:12px;vertical-align:middle"></span> marginal (2k\u20136k) \u00b7 <span class="majority-bar vulnerable" style="display:inline-block;width:6px;vertical-align:middle"></span> vulnerable (<2k) \u00b7 Headers show Total DEL 2025\u201326. Constituency names link to Parliament.uk.</div></div>';
  }

  // Controls
  h+='<div class="controls"><input class="search-input" type="text" placeholder="Search ministers or departments\u2026" value="'+esc(searchTerm)+'" oninput="onSearch(this.value)"><button class="ctrl-btn" onclick="toggleAll()">'+(allExpanded?"Collapse All":"Expand All")+'</button><button class="ctrl-btn'+(showWealth?" active":"")+'" onclick="toggleWealth()">\u00a3 Wealth</button><button class="ctrl-btn'+(sortByBudget?" active":"")+'" onclick="toggleBudgetSort()">\u00a3 Sort by Budget</button><button class="ctrl-btn" onclick="window.print()">\ud83d\udda8 Print</button>'+(!showKey?'<button class="ctrl-btn" onclick="showKeyBox()">Key</button>':"")+'</div>';

  // View tabs
  h+='<div class="view-tabs"><div class="view-tab'+(currentView==="full"?" active":"")+'" onclick="setView(\'full\')">Full Chart</div><div class="view-tab'+(currentView==="cabinet"?" active":"")+'" onclick="setView(\'cabinet\')">Cabinet Table</div></div>';

  // Filter bar
  if(currentView==="full"){
    h+='<div class="filter-bar"><span class="filter-label">Show:</span>';
    ["all","cabinet","sos","mos"].forEach(function(f){var lb={all:"All Ministers",cabinet:"Cabinet Only",sos:"Secretaries of State",mos:"Ministers of State"};h+='<button class="filter-btn'+(seniorityFilter===f?" active":"")+'" onclick="setFilter(\''+f+'\')">'+lb[f]+'</button>'});
    h+='</div>';
  }

  // Wealth note
  if(showWealth&&currentView==="full"){
    h+='<div class="wealth-note-box"><strong>\u26a0 Wealth Percentile Estimates</strong> \u2014 Badges show estimated position in UK adult wealth distribution (ONS WAS 2020\u201322). <strong>Rough approximations</strong>, not audited. Hover for detail.<br><span style="font-size:10px;opacity:0.8">Median \u2248 \u00a3104k \u00b7 Top 5% \u2248 \u00a3700k+ \u00b7 Top 1% \u2248 \u00a31.9m+ \u00b7 Top 0.1% \u2248 \u00a35m+</span></div>';
  }

  if(currentView==="cabinet"){
    var cab=getCabinetMembers();
    h+='<div class="cabinet-table">';
    cab.forEach(function(m){var ph=photoURL(m.name);var inf=MP_INFO[m.name]||{};var pt=ph?'<img src="'+ph+'" alt="" loading="lazy" onerror="this.style.display=\'none\'">':'<div style="width:48px;height:48px;border-radius:50%;background:#e2e4e9;margin:0 auto 6px"></div>';h+='<div class="cabinet-card" style="border-top:3px solid '+m.color+'">'+pt+'<div class="cc-name">'+esc(m.name.replace(/ MP$/,"").replace(/^(Rt Hon |Sir |Dame )/,""))+'</div><div class="cc-dept">'+esc(m.dept)+'</div>'+(inf.con?'<div class="cc-con">'+esc(inf.con)+'</div>':'')+'</div>'});
    h+='</div>';
  } else {
    // PM
    h+='<div class="pm-card"><div class="pm-label">Prime Minister</div><div class="pm-name">The Rt Hon Sir Keir Starmer KCB KC MP'+(showWealth?(function(){var w=WEALTH_EST["Sir Keir Starmer KCB KC MP"],p=getPercentile(w);return' <span class="wealth-badge wb-top1" style="font-size:11px;padding:3px 8px" title="Est. wealth: '+formatWealth(w)+' \u2014 Wealthier than ~'+p+'% of UK adults">\u00a3 Top '+parseFloat((100-p).toFixed(2))+'%</span>'})():"")+'</div><div class="pm-titles">First Lord of the Treasury \u00b7 Minister for the Civil Service \u00b7 Minister for the Union</div><div class="minister-constituency" style="text-align:center;margin-top:4px"><a href="https://members.parliament.uk/member/4514/contact" target="_blank" rel="noopener" style="color:rgba(255,255,255,0.85)">Holborn and St Pancras</a> \u00b7 <span style="color:rgba(255,255,255,0.75)">maj. 11,572</span></div></div>';

    // Cross-cutting
    h+='<div class="cross-box"><div class="section-title">Cross-Cutting & Law Officers</div><div class="cross-grid">'+CROSS_CUTTING.map(function(m){return ministerHTML(m,"mos","#1a1a2e")}).join("")+'</div></div>';

    // Departments
    h+='<div class="dept-grid">'+filtered.map(function(d){return deptHTML(d)}).join("")+'</div>';

    // Whips
    h+='<div class="whips-box"><div class="section-title">Government Whips \u2014 Party Discipline & Parliamentary Business</div><div class="whips-grid"><div><div class="whip-column-title">House of Commons</div>'+ministerHTML({name:"Jonathan Reynolds MP",title:"Parliamentary Secretary to the Treasury (Chief Whip)",rt:true},"secretary","#1a1a2e")+ministerHTML({name:"Sir Mark Tami MP",title:"Treasurer of HM Household (Deputy Chief Whip)",rt:false},"mos","#1a1a2e")+ministerHTML({name:"Sir Nic Dakin MP",title:"Vice Chamberlain of HM Household (Government Whip)",rt:false},"mos","#1a1a2e")+'<div class="whip-note">Plus Lords Commissioners of the Treasury and Assistant Whips</div></div><div><div class="whip-column-title">House of Lords</div>'+LORDS_WHIPS.map(function(w,i){return'<div class="lords-whip '+(i<2?"senior":"junior")+'">'+esc(w)+'</div>'}).join("")+'</div></div></div>';
  }

  // Footer
  h+='<div class="footer">Data: GOV.UK/government/ministers, Hansard, House of Commons Library (Jan\u2013Feb 2026). Wealth: published estimates + ONS WAS 2020\u201322. Budgets: HM Treasury Main Estimates 2025\u201326. Majorities: 2024 GE. Photos: members-api.parliament.uk. Not audited.<br>Some ministers serve across departments. PPS omitted. \u201cPaid as whip\u201d = dual appointment. \u201cUnpaid\u201d = no ministerial salary.</div>';

  document.getElementById("app").innerHTML=h;
}

// EVENTS
function toggleDept(id){if(expandedDepts.has(id))expandedDepts.delete(id);else expandedDepts.add(id);render()}
function toggleAll(){if(allExpanded)expandedDepts.clear();else DEPARTMENTS.forEach(function(d){expandedDepts.add(d.id)});allExpanded=!allExpanded;render()}
function hideKey(){showKey=false;render()}
function showKeyBox(){showKey=true;render()}
function onSearch(v){searchTerm=v;render()}
function toggleWealth(){showWealth=!showWealth;render()}
function toggleChangelog(){showChangelog=!showChangelog;render()}
function setView(v){currentView=v;render()}
function setFilter(f){seniorityFilter=f;render()}
function toggleBudgetSort(){sortByBudget=!sortByBudget;render()}

render();
</script>
</body>
</html>
